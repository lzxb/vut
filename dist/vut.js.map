{"version":3,"file":"vut.js","sources":["../src/util.js","../src/vut.js"],"sourcesContent":["const util = {\n  isObject (obj) {\n    return !!obj && Object.prototype.toString.call(obj) === '[object Object]'\n  },\n  error (msg) {\n    throw new Error(`[Vut] ${msg}`)\n  },\n  has (obj, attr) {\n    return Object.prototype.hasOwnProperty.call(obj, attr)\n  },\n  callHook (vut, goods, name) {\n    vut.plugins.forEach(plugin => {\n      if (!util.has(plugin, name)) return\n      plugin[name].call(goods)\n    })\n  }\n}\n\nexport default util\n","import util from './util'\n\nclass Vut {\n  constructor () {\n    this.store = {}\n    this.plugins = []\n  }\n  use (plugin, options) {\n    if (Object.keys(this.store).length) {\n      util.error(`plugin must in create store before call`)\n    }\n    if (typeof plugin !== 'function') {\n      util.error(`plugin not is function type`)\n    }\n    const mixin = plugin(this, options)\n    if (!util.isObject(mixin)) {\n      util.error(`plugin return value not is object type`)\n    }\n    this.plugins.push(mixin)\n    return this\n  }\n  create (name, options) {\n    if (typeof name !== 'string') {\n      util.error(`'name' not is string type`)\n    }\n    if (!util.isObject(options)) {\n      util.error(`'options' not is object type`)\n    }\n    if (util.has(this.store, name)) {\n      util.error(`'${name}' already is in store`)\n    }\n    if (typeof options.data !== 'function') {\n      util.error(`'${name}' not is function type`)\n    }\n    const goods = Object.create(null)\n    goods.$options = options\n    util.callHook(this, goods, 'beforeCreate')\n    // Bind methods\n    Object.keys(goods.$options).forEach(fnName => {\n      goods[fnName] = function action () {\n        const res = goods.$options[fnName].apply(goods, arguments)\n        return res\n      }\n    })\n    // Compression path\n    goods.$state = goods.data()\n    if (!util.isObject(goods.$state)) {\n      util.error(`'${name}' return value not is object type`)\n    }\n    Object.keys(goods.$state).forEach(attrName => {\n      Object.defineProperty(goods, attrName, {\n        get () {\n          return goods.$state[attrName]\n        },\n        set (val) {\n          goods.$state[attrName] = val\n        }\n      })\n    })\n    this.store[name] = goods\n    util.callHook(this, goods, 'created')\n    return this\n  }\n  destroy () {\n    Object.keys(this.store).forEach(goods => {\n      util.callHook(this, this.store[goods], 'beforeDestroy')\n      util.callHook(this, this.store[goods], 'destroyed')\n    })\n  }\n}\n\nObject.assign(Vut, {\n  util\n})\n\nexport default Vut\n"],"names":["util","obj","Object","prototype","toString","call","msg","Error","attr","hasOwnProperty","vut","goods","name","plugins","forEach","has","plugin","Vut","store","options","keys","length","error","mixin","isObject","push","data","create","$options","callHook","fnName","action","res","apply","arguments","$state","defineProperty","attrName","val","assign"],"mappings":"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"}