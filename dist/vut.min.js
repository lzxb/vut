!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Vut=e()}(this,function(){"use strict";var t={isObject:function(t){return!!t&&"[object Object]"===Object.prototype.toString.call(t)},error:function(t){throw new Error("[Vut] "+t)},has:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},callHook:function(e,n,o){e.plugins.forEach(function(e){t.has(e,o)&&e[o].call(n)})}},e=(function(){function t(t){this.value=t}function e(e){function n(r,i){try{var u=e[r](i),c=u.value;c instanceof t?Promise.resolve(c.value).then(function(t){n("next",t)},function(t){n("throw",t)}):o(u.done?"return":"normal",u.value)}catch(t){o("throw",t)}}function o(t,e){switch(t){case"return":r.resolve({value:e,done:!0});break;case"throw":r.reject(e);break;default:r.resolve({value:e,done:!1})}(r=r.next)?n(r.key,r.arg):i=null}var r,i;this._invoke=function(t,e){return new Promise(function(o,u){var c={key:t,arg:e,resolve:o,reject:u,next:null};i?i=i.next=c:(r=i=c,n(t,e))})},"function"!=typeof e.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(t){return this._invoke("next",t)},e.prototype.throw=function(t){return this._invoke("throw",t)},e.prototype.return=function(t){return this._invoke("return",t)}}(),function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}),n=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),o=function(){function o(){e(this,o),this.store={},this.plugins=[]}return n(o,[{key:"use",value:function(e,n){Object.keys(this.store).length&&t.error("plugin must in create store before call"),"function"!=typeof e&&t.error("plugin not is function type");var o=e(this,n);return t.isObject(o)||t.error("plugin return value not is object type"),this.plugins.push(o),this}},{key:"create",value:function(e,n){"string"!=typeof e&&t.error("'name' not is string type"),t.isObject(n)||t.error("'options' not is object type"),t.has(this.store,e)&&t.error("'"+e+"' already is in store"),"function"!=typeof n.data&&t.error("'"+e+"' not is function type");var o=Object.create(null);return o.$options=n,t.callHook(this,o,"beforeCreate"),Object.keys(o.$options).forEach(function(t){o[t]=function(){return o.$options[t].apply(o,arguments)}}),o.$state=o.data(),t.isObject(o.$state)||t.error("'"+e+"' return value not is object type"),Object.keys(o.$state).forEach(function(t){Object.defineProperty(o,t,{get:function(){return o.$state[t]},set:function(e){o.$state[t]=e}})}),this.store[e]=o,t.callHook(this,o,"created"),this}},{key:"destroy",value:function(){var e=this;Object.keys(this.store).forEach(function(n){t.callHook(e,e.store[n],"beforeDestroy"),t.callHook(e,e.store[n],"destroyed")})}}]),o}();return Object.assign(o,{util:t}),o});
