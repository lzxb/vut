!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Vut=e()}(this,function(){"use strict";!function(){function t(t){this.value=t}function e(e){function n(o,i){try{var u=e[o](i),c=u.value;c instanceof t?Promise.resolve(c.value).then(function(t){n("next",t)},function(t){n("throw",t)}):r(u.done?"return":"normal",u.value)}catch(t){r("throw",t)}}function r(t,e){switch(t){case"return":o.resolve({value:e,done:!0});break;case"throw":o.reject(e);break;default:o.resolve({value:e,done:!1})}(o=o.next)?n(o.key,o.arg):i=null}var o,i;this._invoke=function(t,e){return new Promise(function(r,u){var c={key:t,arg:e,resolve:r,reject:u,next:null};i?i=i.next=c:(o=i=c,n(t,e))})},"function"!=typeof e.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(t){return this._invoke("next",t)},e.prototype.throw=function(t){return this._invoke("throw",t)},e.prototype.return=function(t){return this._invoke("return",t)}}();var t=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},e=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),n={isObject:function(t){return!!t&&"[object Object]"===Object.prototype.toString.call(t)},error:function(t){throw new Error("[Vut] "+t)},has:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},callHook:function(t,e,r){t.plugins.forEach(function(t){n.has(t,r)&&t[r].call(e)})}};return function(){function r(){t(this,r),this.store={},this.plugins=[]}return e(r,[{key:"use",value:function(t,e){Object.keys(this.store).length&&n.error("plugin must in create store before call"),"function"!=typeof t&&n.error("plugin not is function type");var r=t(this,e);return n.isObject(r)||n.error("plugin return value not is object type"),this.plugins.push(r),this}},{key:"create",value:function(t,e){"string"!=typeof t&&n.error("'name' not is string type"),n.isObject(e)||n.error("'options' not is object type"),n.has(this.store,t)&&n.error("'"+t+"' already is in store"),"function"!=typeof e.data&&n.error("'"+t+"' not is function type");var r=Object.create(null);return r.$options=e,n.callHook(this,r,"beforeCreate"),Object.keys(r.$options).forEach(function(t){r[t]=function(){return r.$options[t].apply(r,arguments)}}),r.$state=r.data(),n.isObject(r.$state)||n.error("'"+t+"' return value not is object type"),Object.keys(r.$state).forEach(function(t){Object.defineProperty(r,t,{get:function(){return r.$state[t]},set:function(e){r.$state[t]=e}})}),this.store[t]=r,n.callHook(this,r,"created"),this}}]),r}()});
